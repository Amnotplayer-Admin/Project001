#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÉ‡∏ô‡∏ã‡∏≠‡∏£‡πå‡∏™‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ (Simple Vulnerability Predictor)
‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Python built-in modules ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á packages ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢: AI Assistant
‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: 1.0
"""

import re
import os
import json
from datetime import datetime

class SimpleVulnerabilityPredictor:
    def __init__(self):
        self.vulnerability_patterns = {
            'code_injection': [
                r'eval\s*\(',
                r'exec\s*\(',
                r'__import__\s*\(',
                r'compile\s*\('
            ],
            'sql_injection': [
                r'SELECT.*FROM.*WHERE.*\+',
                r'INSERT.*INTO.*\+',
                r'UPDATE.*SET.*\+',
                r'DELETE.*FROM.*WHERE.*\+',
                r'DROP.*TABLE.*\+',
                r'CREATE.*TABLE.*\+'
            ],
            'command_injection': [
                r'os\.system\s*\(',
                r'subprocess\.call\s*\(',
                r'subprocess\.Popen\s*\(',
                r'commands\.getoutput\s*\('
            ],
            'file_traversal': [
                r'open\s*\(\s*[^)]*\+\s*[^)]*\)',
                r'file\s*\(\s*[^)]*\+\s*[^)]*\)',
                r'os\.path\.join\s*\(\s*[^)]*\+\s*[^)]*\)'
            ],
            'pickle_deserialization': [
                r'pickle\.loads\s*\(',
                r'pickle\.load\s*\(',
                r'cPickle\.loads\s*\(',
                r'cPickle\.load\s*\('
            ],
            'http_request': [
                r'urllib\.request\.urlopen\s*\(',
                r'urllib2\.urlopen\s*\(',
                r'requests\.get\s*\(',
                r'requests\.post\s*\('
            ],
            'password_exposure': [
                r'print\s*\(\s*[^)]*password[^)]*\)',
                r'print\s*\(\s*[^)]*passwd[^)]*\)',
                r'print\s*\(\s*[^)]*secret[^)]*\)',
                r'logging\s*\(\s*[^)]*password[^)]*\)'
            ],
            'directory_traversal': [
                r'os\.listdir\s*\(\s*[^)]*\+\s*[^)]*\)',
                r'os\.chdir\s*\(\s*[^)]*\+\s*[^)]*\)',
                r'os\.makedirs\s*\(\s*[^)]*\+\s*[^)]*\)'
            ]
        }
        
        self.security_keywords = [
            'password', 'secret', 'key', 'token', 'auth', 'login', 'admin',
            'sql', 'query', 'execute', 'eval', 'exec', 'system', 'shell',
            'file', 'upload', 'download', 'path', 'directory', 'http', 'https',
            'cookie', 'session', 'csrf', 'xss', 'injection', 'overflow',
            'buffer', 'stack', 'heap', 'race', 'condition', 'deadlock'
        ]
        
        self.dangerous_functions = [
            'eval', 'exec', 'system', 'os.system', 'subprocess.call',
            'subprocess.Popen', 'commands.getoutput', 'input', 'raw_input',
            'open', 'file', 'pickle.loads', 'pickle.load', 'cPickle.loads',
            'cPickle.load', 'marshal.loads', 'marshal.load'
        ]
    
    def analyze_code(self, code):
        """‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà"""
        results = {
            'is_vulnerable': False,
            'vulnerability_count': 0,
            'vulnerabilities': [],
            'risk_level': 'LOW',
            'features': {},
            'recommendations': []
        }
        
        # ‡∏™‡∏Å‡∏±‡∏î‡∏Ñ‡∏∏‡∏ì‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
        results['features'] = self.extract_basic_features(code)
        
        # ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà
        for vuln_type, patterns in self.vulnerability_patterns.items():
            for pattern in patterns:
                matches = re.findall(pattern, code, re.IGNORECASE)
                if matches:
                    results['vulnerabilities'].append({
                        'type': vuln_type,
                        'pattern': pattern,
                        'matches': len(matches),
                        'risk': self.get_risk_level(vuln_type)
                    })
                    results['vulnerability_count'] += len(matches)
        
        # ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
        security_count = 0
        for keyword in self.security_keywords:
            security_count += code.lower().count(keyword)
        
        # ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢
        dangerous_count = 0
        for func in self.dangerous_functions:
            dangerous_count += code.lower().count(func)
        
        # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á
        if results['vulnerability_count'] > 0:
            results['is_vulnerable'] = True
            if results['vulnerability_count'] >= 5:
                results['risk_level'] = 'CRITICAL'
            elif results['vulnerability_count'] >= 3:
                results['risk_level'] = 'HIGH'
            elif results['vulnerability_count'] >= 1:
                results['risk_level'] = 'MEDIUM'
        
        # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
        results['recommendations'] = self.generate_recommendations(results)
        
        return results
    
    def extract_basic_features(self, code):
        """‡∏™‡∏Å‡∏±‡∏î‡∏Ñ‡∏∏‡∏ì‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î"""
        features = {
            'lines': len(code.split('\n')),
            'chars': len(code),
            'words': len(code.split()),
            'security_keywords': 0,
            'dangerous_functions': 0,
            'sql_queries': 0,
            'http_usage': 0
        }
        
        # ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
        for keyword in self.security_keywords:
            features['security_keywords'] += code.lower().count(keyword)
        
        # ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢
        for func in self.dangerous_functions:
            features['dangerous_functions'] += code.lower().count(func)
        
        # ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ SQL
        sql_patterns = [
            r'SELECT', r'INSERT', r'UPDATE', r'DELETE', r'DROP', r'CREATE', r'ALTER'
        ]
        for pattern in sql_patterns:
            features['sql_queries'] += len(re.findall(pattern, code, re.IGNORECASE))
        
        # ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ HTTP
        http_patterns = [
            r'http://', r'https://', r'urllib', r'requests', r'urllib2'
        ]
        for pattern in http_patterns:
            features['http_usage'] += len(re.findall(pattern, code, re.IGNORECASE))
        
        return features
    
    def get_risk_level(self, vuln_type):
        """‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà"""
        high_risk = ['code_injection', 'command_injection', 'sql_injection']
        medium_risk = ['file_traversal', 'pickle_deserialization', 'directory_traversal']
        
        if vuln_type in high_risk:
            return 'HIGH'
        elif vuln_type in medium_risk:
            return 'MEDIUM'
        else:
            return 'LOW'
    
    def generate_recommendations(self, results):
        """‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏≤‡∏°‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå"""
        recommendations = []
        
        if results['is_vulnerable']:
            recommendations.append("‚ö†Ô∏è  ‡∏û‡∏ö‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç")
            
            for vuln in results['vulnerabilities']:
                if vuln['type'] == 'code_injection':
                    recommendations.append("‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ eval(), exec() ‡∏´‡∏£‡∏∑‡∏≠ __import__()")
                elif vuln['type'] == 'sql_injection':
                    recommendations.append("‚Ä¢ ‡πÉ‡∏ä‡πâ parameterized queries ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠ string")
                elif vuln['type'] == 'command_injection':
                    recommendations.append("‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ os.system() ‡∏´‡∏£‡∏∑‡∏≠ subprocess.call()")
                elif vuln['type'] == 'file_traversal':
                    recommendations.append("‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö path ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå")
                elif vuln['type'] == 'pickle_deserialization':
                    recommendations.append("‚Ä¢ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ pickle.loads() ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ")
                elif vuln['type'] == 'http_request':
                    recommendations.append("‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î")
                elif vuln['type'] == 'password_exposure':
                    recommendations.append("‚Ä¢ ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç")
                elif vuln['type'] == 'directory_traversal':
                    recommendations.append("‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö directory path ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á")
        
        if results['features']['security_keywords'] > 10:
            recommendations.append("‚Ä¢ ‡πÇ‡∏Ñ‡πâ‡∏î‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏°‡∏≤‡∏Å ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°")
        
        if results['features']['dangerous_functions'] > 0:
            recommendations.append("‚Ä¢ ‡∏û‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢ ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô")
        
        if not recommendations:
            recommendations.append("‚úÖ ‡πÇ‡∏Ñ‡πâ‡∏î‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô")
        
        return recommendations
    
    def analyze_file(self, filepath):
        """‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏Ñ‡πâ‡∏î"""
        try:
            with open(filepath, 'r', encoding='utf-8') as f:
                code = f.read()
            
            results = self.analyze_code(code)
            results['file_info'] = {
                'path': filepath,
                'size': os.path.getsize(filepath),
                'modified': datetime.fromtimestamp(os.path.getmtime(filepath))
            }
            
            return results
        except Exception as e:
            return {
                'error': f"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ: {str(e)}",
                'is_vulnerable': False
            }
    
    def save_analysis_report(self, results, filepath):
        """‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå"""
        try:
            report = {
                'timestamp': datetime.now().isoformat(),
                'results': results
            }
            
            with open(filepath, 'w', encoding='utf-8') as f:
                json.dump(report, f, indent=2, ensure_ascii=False, default=str)
            
            return True
        except Exception as e:
            print(f"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ: {str(e)}")
            return False
    
    def print_analysis_results(self, results):
        """‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢"""
        print("\n" + "="*60)
        print("‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÉ‡∏ô‡∏ã‡∏≠‡∏£‡πå‡∏™‡πÇ‡∏Ñ‡πâ‡∏î")
        print("="*60)
        
        if 'error' in results:
            print(f"‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: {results['error']}")
            return
        
        # ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•
        if results['is_vulnerable']:
            print(f"‚ö†Ô∏è  ‡∏û‡∏ö‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà {results['vulnerability_count']} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£")
            print(f"‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: {results['risk_level']}")
        else:
            print("‚úÖ ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà")
        
        # ‡∏Ñ‡∏∏‡∏ì‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
        print(f"\nüìä ‡∏Ñ‡∏∏‡∏ì‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô:")
        features = results['features']
        print(f"‚Ä¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î: {features['lines']}")
        print(f"‚Ä¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£: {features['chars']}")
        print(f"‚Ä¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥: {features['words']}")
        print(f"‚Ä¢ ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢: {features['security_keywords']}")
        print(f"‚Ä¢ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢: {features['dangerous_functions']}")
        print(f"‚Ä¢ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ SQL: {features['sql_queries']}")
        print(f"‚Ä¢ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ HTTP: {features['http_usage']}")
        
        # ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà
        if results['vulnerabilities']:
            print(f"\nüö® ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà:")
            for i, vuln in enumerate(results['vulnerabilities'], 1):
                print(f"{i}. ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: {vuln['type']}")
                print(f"   ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á: {vuln['risk']}")
                print(f"   ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏ö: {vuln['matches']}")
        
        # ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
        print(f"\nüí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:")
        for rec in results['recommendations']:
            print(f"‚Ä¢ {rec}")
        
        print("\n" + "="*60)

def main():
    """‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö"""
    predictor = SimpleVulnerabilityPredictor()
    
    print("‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÉ‡∏ô‡∏ã‡∏≠‡∏£‡πå‡∏™‡πÇ‡∏Ñ‡πâ‡∏î‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢")
    print("‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Python built-in modules")
    
    # ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
    print("\n‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà:")
    
    vulnerable_code = '''
password = input("Enter password: ")
print(f"Password: {password}")

user_id = input("Enter user ID: ")
query = f"SELECT * FROM users WHERE id = {user_id}"

user_command = input("Enter command: ")
os.system(user_command)

filename = input("Enter filename: ")
with open(filename, 'r') as f:
    content = f.read()
    '''
    
    results = predictor.analyze_code(vulnerable_code)
    predictor.print_analysis_results(results)
    
    # ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
    predictor.save_analysis_report(results, "vulnerability_report.json")
    print("\nüìÑ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á: vulnerability_report.json")

if __name__ == "__main__":
    main()
